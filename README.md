# unifi-fw-cache.sh

Скрипт для офлайн-кэширования прошивок UniFi на контроллере UniFi Network Application.

Позволяет:

- заранее скачивать прошивки для конкретных моделей из `firmware.json` контроллера;
- докладывать прошивки из локальной папки или по прямым URL;
- автоматически раскладывать файлы в структуру:
  `/<UNIFI_FW_DIR>/<CODE>/<VERSION>/<FILENAME>`;
- актуализировать `firmware_meta.json`, чтобы контроллер видел кэш как «родной».

Сценарий полезен, когда:

- контроллеру запрещён прямой выход в интернет;
- доступ к `fw-download.ubnt.com` режется ИБ/файрволами;
- прошивки нужно кэшировать через временный прокси;
- нужно массово закатать несколько версий прошивок офлайн.

---

## Требования

- Bash (используются массивы, process substitution и т.п.);
- `jq`
- `wget`
- `md5sum`
- `stat`, `install` (из coreutils)
- root-права (доступ к `/var/lib/unifi` и управлению службой `unifi`);
- UniFi Network Application (контроллер), например 9.x.

По умолчанию скрипт:

- работает с кэшем контроллера в `/var/lib/unifi/firmware`;
- читает каталог прошивок из `/var/lib/unifi/firmware.json`;
- перезапускает службу `unifi` после изменений.

Все эти пути и поведение можно переопределить через переменные окружения.

---

## Установка

```bash
git clone https://github.com/<your-account>/unifi-fw-cache.git
cd unifi-fw-cache

# Сделать скрипт исполняемым
chmod +x unifi-fw-cache.sh
